{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import StudentCard from'./StudentCard';import StudentDetailModal from'./StudentDetailModal';import'./StudentList.css';import{fetchStudents}from'../api/studentAPI';import{groupByRegNo}from'../utils/groupByRegNo';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function StudentList(_ref){let{filter,year,searchTerm,schoolFilter,typeFilter}=_ref;const[students,setStudents]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[selectedStudent,setSelectedStudent]=useState(null);useEffect(()=>{const loadStudents=async()=>{setLoading(true);setError(null);try{const data=await fetchStudents(filter,year,searchTerm,schoolFilter,typeFilter);console.log(\"Fetched data:\",data);if(Array.isArray(data)){const groupedData=groupByRegNo(data);// Filter students based on schoolFilter and typeFilter\nconst filteredStudents=Object.values(groupedData).filter(studentGroup=>{const firstStudent=studentGroup[0];// Assuming all students in a group have the same school and type\nconst matchesSchool=schoolFilter?firstStudent.School&&firstStudent.School.toLowerCase()===schoolFilter.toLowerCase():true;const matchesType=typeFilter?firstStudent.Type&&firstStudent.Type.toLowerCase()===typeFilter.toLowerCase():true;return matchesSchool&&matchesType;});setStudents(filteredStudents);}else{console.error('Fetched data is not an array:',data);setStudents([]);setError('Unexpected data format from server.');}}catch(error){console.error('Error loading students:',error);setError('Failed to load student data.');}finally{setLoading(false);}};loadStudents();},[filter,year,searchTerm,schoolFilter,typeFilter]);// Added schoolFilter and typeFilter as dependencies\nconst handleStudentClick=student=>{setSelectedStudent(student);};const closeModal=()=>{setSelectedStudent(null);};const studentCards=useMemo(()=>{return students.map(student=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleStudentClick(student),children:[/*#__PURE__*/_jsx(StudentCard,{student:student}),\" \"]},student.Reg_No));},[students]);if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\" Loading... \"});}if(error){return/*#__PURE__*/_jsxs(\"p\",{className:\"error-message\",children:[\" \",error,\" \"]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"student-list\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginLeft:'20px',fontSize:'30px'},children:\" Students \"}),\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"student-cards-container\",children:[\" \",students.length===0?/*#__PURE__*/_jsx(\"p\",{children:\" No students found matching this criteria. \"}):studentCards,\" \"]}),\" \",selectedStudent&&/*#__PURE__*/_jsx(StudentDetailModal,{student:selectedStudent,onClose:closeModal}),\" \"]});}export default StudentList;","map":{"version":3,"names":["React","useState","useEffect","useMemo","StudentCard","StudentDetailModal","fetchStudents","groupByRegNo","jsx","_jsx","jsxs","_jsxs","StudentList","_ref","filter","year","searchTerm","schoolFilter","typeFilter","students","setStudents","loading","setLoading","error","setError","selectedStudent","setSelectedStudent","loadStudents","data","console","log","Array","isArray","groupedData","filteredStudents","Object","values","studentGroup","firstStudent","matchesSchool","School","toLowerCase","matchesType","Type","handleStudentClick","student","closeModal","studentCards","map","onClick","children","Reg_No","className","style","marginLeft","fontSize","length","onClose"],"sources":["/Users/roopakowshika/placement/placement__/frontend/src/components/StudentList.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport StudentCard from './StudentCard';\nimport StudentDetailModal from './StudentDetailModal';\nimport './StudentList.css';\nimport { fetchStudents } from '../api/studentAPI';\nimport { groupByRegNo } from '../utils/groupByRegNo';\n\nfunction StudentList({ filter, year, searchTerm, schoolFilter, typeFilter }) {\n    const [students, setStudents] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [selectedStudent, setSelectedStudent] = useState(null);\n\n    useEffect(() => {\n        const loadStudents = async() => {\n            setLoading(true);\n            setError(null);\n\n            try {\n                const data = await fetchStudents(filter, year, searchTerm, schoolFilter, typeFilter);\n                console.log(\"Fetched data:\", data);\n\n                if (Array.isArray(data)) {\n                    const groupedData = groupByRegNo(data);\n\n                    // Filter students based on schoolFilter and typeFilter\n                    const filteredStudents = Object.values(groupedData).filter(studentGroup => {\n                        const firstStudent = studentGroup[0]; // Assuming all students in a group have the same school and type\n                        const matchesSchool = schoolFilter ?\n                            firstStudent.School && firstStudent.School.toLowerCase() === schoolFilter.toLowerCase() :\n                            true;\n\n                        const matchesType = typeFilter ?\n                            firstStudent.Type && firstStudent.Type.toLowerCase() === typeFilter.toLowerCase() :\n                            true;\n\n                        return matchesSchool && matchesType;\n                    });\n\n                    setStudents(filteredStudents);\n                } else {\n                    console.error('Fetched data is not an array:', data);\n                    setStudents([]);\n                    setError('Unexpected data format from server.');\n                }\n            } catch (error) {\n                console.error('Error loading students:', error);\n                setError('Failed to load student data.');\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        loadStudents();\n    }, [filter, year, searchTerm, schoolFilter, typeFilter]); // Added schoolFilter and typeFilter as dependencies\n\n    const handleStudentClick = (student) => {\n        setSelectedStudent(student);\n    };\n\n    const closeModal = () => {\n        setSelectedStudent(null);\n    };\n\n    const studentCards = useMemo(() => {\n        return students.map(student => ( <\n            div key = { student.Reg_No }\n            onClick = {\n                () => handleStudentClick(student) } >\n            <\n            StudentCard student = { student }\n            /> <\n            /div>\n        ));\n    }, [students]);\n\n    if (loading) {\n        return <p > Loading... < /p>;\n    }\n\n    if (error) {\n        return <p className = \"error-message\" > { error } < /p>;\n    }\n\n    return ( <\n        div className = \"student-list\" >\n        <\n        h2 style = {\n            { marginLeft: '20px', fontSize: '30px' } } > Students < /h2> <\n        div className = \"student-cards-container\" > {\n            students.length === 0 ? ( <\n                p > No students found matching this criteria. < /p>\n            ) : (\n                studentCards\n            )\n        } <\n        /div> {\n            selectedStudent && ( <\n                StudentDetailModal student = { selectedStudent }\n                onClose = { closeModal }\n                />\n            )\n        } <\n        /div>\n    );\n}\n\nexport default StudentList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}